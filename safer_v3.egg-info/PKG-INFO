Metadata-Version: 2.4
Name: safer_v3
Version: 3.0.0
Summary: Scalable Aerospace Failure Estimation Runtime - Turbofan Engine Prognostics
Home-page: https://github.com/your-org/safer-v3
Author: SAFER Development Team
Classifier: Development Status :: 4 - Beta
Classifier: Intended Audience :: Science/Research
Classifier: License :: OSI Approved :: MIT License
Classifier: Operating System :: OS Independent
Classifier: Programming Language :: Python :: 3
Classifier: Programming Language :: Python :: 3.9
Classifier: Programming Language :: Python :: 3.10
Classifier: Programming Language :: Python :: 3.11
Classifier: Topic :: Scientific/Engineering :: Artificial Intelligence
Requires-Python: >=3.9
Description-Content-Type: text/markdown
Requires-Dist: torch>=2.0.0
Requires-Dist: numpy>=1.24.0
Requires-Dist: pandas>=2.0.0
Requires-Dist: scipy>=1.10.0
Requires-Dist: scikit-learn>=1.2.0
Requires-Dist: pyyaml>=6.0
Requires-Dist: dataclasses-json>=0.5.0
Requires-Dist: tqdm>=4.65.0
Requires-Dist: matplotlib>=3.7.0
Requires-Dist: seaborn>=0.12.0
Requires-Dist: onnx>=1.14.0
Requires-Dist: onnxruntime>=1.15.0
Requires-Dist: pytest>=7.0.0
Requires-Dist: pytest-cov>=4.0.0
Requires-Dist: black>=23.0.0
Requires-Dist: isort>=5.12.0
Requires-Dist: mypy>=1.0.0
Requires-Dist: flake8>=6.0.0
Requires-Dist: sphinx>=6.0.0
Requires-Dist: sphinx-rtd-theme>=1.2.0
Requires-Dist: jupyter>=1.0.0
Requires-Dist: ipykernel>=6.0.0
Provides-Extra: dev
Requires-Dist: pytest>=7.0.0; extra == "dev"
Requires-Dist: pytest-cov>=4.0.0; extra == "dev"
Requires-Dist: black>=23.0.0; extra == "dev"
Requires-Dist: isort>=5.12.0; extra == "dev"
Requires-Dist: mypy>=1.0.0; extra == "dev"
Requires-Dist: flake8>=6.0.0; extra == "dev"
Provides-Extra: docs
Requires-Dist: sphinx>=6.0.0; extra == "docs"
Requires-Dist: sphinx-rtd-theme>=1.2.0; extra == "docs"
Provides-Extra: viz
Requires-Dist: matplotlib>=3.7.0; extra == "viz"
Requires-Dist: seaborn>=0.12.0; extra == "viz"
Dynamic: author
Dynamic: classifier
Dynamic: description
Dynamic: description-content-type
Dynamic: home-page
Dynamic: provides-extra
Dynamic: requires-dist
Dynamic: requires-python
Dynamic: summary

# SAFER v3.0

**Scalable Aerospace Failure Estimation Runtime**

A tri-partite architecture for aerospace turbofan engine prognostics combining deep learning, physics-informed monitoring, and runtime safety assurance.

## Overview

SAFER v3.0 implements a novel approach to Remaining Useful Life (RUL) prediction for turbofan engines:

```
┌─────────────────────────────────────────────────────────────────────────┐
│                           SAFER v3.0 Architecture                        │
├─────────────────────────────────────────────────────────────────────────┤
│                                                                          │
│  ┌──────────────┐    ┌──────────────┐    ┌──────────────┐              │
│  │    Mamba     │    │   LPV-SINDy  │    │   Baseline   │              │
│  │  Predictor   │    │   Physics    │    │  Predictor   │              │
│  │   (DAL E)    │    │   Monitor    │    │   (DAL C)    │              │
│  └──────┬───────┘    └──────┬───────┘    └──────┬───────┘              │
│         │                   │                   │                       │
│         └───────────────────┼───────────────────┘                       │
│                             ▼                                            │
│                   ┌─────────────────┐                                   │
│                   │ Simplex Decision │                                   │
│                   │     Module       │                                   │
│                   └────────┬────────┘                                   │
│                            ▼                                             │
│                   ┌─────────────────┐                                   │
│                   │  Conformal UQ   │                                   │
│                   │  Alert Manager  │                                   │
│                   └─────────────────┘                                   │
│                                                                          │
└─────────────────────────────────────────────────────────────────────────┘
```

### Key Components

1. **Mamba RUL Predictor** (DAL E): State-space model for high-accuracy prediction
2. **LPV-SINDy Physics Monitor** (DAL C): Data-driven physics model for anomaly detection
3. **Baseline Predictor** (DAL C): Conservative LSTM/Transformer for safety fallback
4. **Simplex Decision Module**: Runtime arbitration with safety guarantees
5. **Conformal Prediction**: Distribution-free uncertainty quantification
6. **Shared Memory Fabric**: Lock-free inter-process communication

## Features

- **Pure PyTorch Implementation**: No CUDA kernels or Triton dependencies
- **ONNX Export**: Deploy models in production environments
- **Ensemble Support**: Multiple model training for uncertainty estimation
- **Conformal Prediction**: Calibrated prediction intervals with coverage guarantees
- **Physics-Informed Monitoring**: LPV-SINDy for interpretable anomaly detection
- **Safety Assurance**: Simplex architecture for runtime switching
- **Lock-Free Communication**: High-performance shared memory transport

## Installation

```bash
# Clone the repository
git clone https://github.com/your-org/safer-v3.git
cd safer-v3

# Create virtual environment
python -m venv venv
source venv/bin/activate  # Linux/Mac
venv\Scripts\activate     # Windows

# Install dependencies
pip install -r requirements.txt

# Install SAFER package
pip install -e .
```

## Quick Start

### Training Mamba Predictor

```bash
python -m safer_v3.scripts.train_mamba \
    --data_dir CMAPSSData \
    --dataset FD001 \
    --epochs 100 \
    --batch_size 64 \
    --export_onnx
```

### Training Baseline Models

```bash
# Train all baselines for comparison
python -m safer_v3.scripts.train_baselines \
    --data_dir CMAPSSData \
    --dataset FD001 \
    --model all

# Train specific baseline
python -m safer_v3.scripts.train_baselines \
    --model lstm \
    --dataset FD001
```

### Using SAFER in Code

```python
from safer_v3.core.mamba import MambaRULPredictor, MambaConfig
from safer_v3.physics.lpv_sindy import LPVSINDyMonitor
from safer_v3.decision.simplex import SimplexDecisionModule
from safer_v3.decision.conformal import SplitConformalPredictor

# Create Mamba predictor
config = MambaConfig(d_input=14, d_model=64, d_state=16, n_layers=4)
mamba = MambaRULPredictor(config)

# Load trained weights
mamba.load_state_dict(torch.load('outputs/mamba_model.pt'))

# Create physics monitor
physics = LPVSINDyMonitor(n_states=14, window_size=5)

# Create decision module
simplex = SimplexDecisionModule()

# Create conformal predictor (after calibration)
conformal = SplitConformalPredictor(coverage=0.9)
conformal.calibrate(y_cal, y_pred_cal)

# Inference
with torch.no_grad():
    mamba_rul = mamba(sensor_sequence)
    baseline_rul = baseline(sensor_sequence)
    physics_residual = physics.detect_anomaly(sensor_sequence)
    
    interval = conformal.predict(mamba_rul.item())
    
    result = simplex.decide(
        complex_rul=mamba_rul.item(),
        baseline_rul=baseline_rul.item(),
        rul_lower=interval.lower,
        rul_upper=interval.upper,
        physics_residual=physics_residual,
    )
    
print(f"RUL: {result.rul:.1f} [{result.rul_lower:.1f}, {result.rul_upper:.1f}]")
print(f"Mode: {result.state.name}")
```

## Project Structure

```
safer_v3/
├── __init__.py
├── utils/
│   ├── config.py          # Configuration dataclasses
│   ├── logging_config.py  # Logging setup
│   └── metrics.py         # RUL metrics and scoring
├── core/
│   ├── ssm_ops.py         # SSM operations (ZOH, parallel scan)
│   ├── mamba.py           # Mamba architecture
│   ├── baselines.py       # LSTM, Transformer, CNN-LSTM
│   └── trainer.py         # Training pipeline
├── physics/
│   ├── library.py         # Function libraries
│   ├── sparse_regression.py  # STLSQ, STRidge, SR3
│   └── lpv_sindy.py       # LPV-SINDy monitor
├── fabric/
│   ├── ring_buffer.py     # Lock-free SPSC buffer
│   ├── shm_transport.py   # Shared memory transport
│   └── process_manager.py # Multi-process management
├── decision/
│   ├── conformal.py       # Conformal prediction
│   ├── alerts.py          # Alert management
│   └── simplex.py         # Simplex decision module
├── simulation/
│   ├── engine_sim.py      # Engine degradation simulation
│   └── data_generator.py  # Synthetic data generation
└── scripts/
    ├── train_mamba.py     # Mamba training script
    └── train_baselines.py # Baseline training script
```

## Data

SAFER v3.0 is designed for the NASA C-MAPSS turbofan engine degradation dataset:

- **FD001**: Single operating condition, single fault mode (100 train, 100 test)
- **FD002**: Six operating conditions, single fault mode
- **FD003**: Single operating condition, two fault modes
- **FD004**: Six operating conditions, two fault modes

Download from: [NASA Prognostics Data Repository](https://ti.arc.nasa.gov/tech/dash/groups/pcoe/prognostic-data-repository/)

### Sensor Selection

SAFER uses 14 prognostic sensors (indices 2, 3, 4, 7, 8, 9, 11, 12, 13, 14, 15, 17, 20, 21) from the 21 available sensors based on correlation with degradation.

## Performance Targets

| Metric | Target | Description |
|--------|--------|-------------|
| RMSE | < 15 cycles | Root mean square error |
| Inference Latency | < 20 ms | End-to-end prediction time |
| Coverage | ≥ 90% | Conformal prediction coverage |
| NASA Score | Minimize | Asymmetric penalty function |

### NASA Scoring Function

```
Score = Σ exp(-d/a₁) - 1  for d < 0 (late prediction)
        Σ exp(d/a₂) - 1   for d ≥ 0 (early prediction)

where d = RUL_pred - RUL_true, a₁ = 13, a₂ = 10
```

## Design Assurance Levels (DAL)

Following DO-178C guidelines:

| Component | DAL | Rationale |
|-----------|-----|-----------|
| Mamba Predictor | E | High performance, monitored |
| Physics Monitor | C | Interpretable, mathematically grounded |
| Baseline Predictor | C | Simple, well-understood |
| Simplex Decision | C | Safety-critical arbiter |

## Configuration

### YAML Configuration

```yaml
# config.yaml
mamba:
  d_input: 14
  d_model: 64
  d_state: 16
  n_layers: 4
  expand: 2
  dropout: 0.1

training:
  epochs: 100
  batch_size: 64
  learning_rate: 0.001
  weight_decay: 0.0001

physics:
  window_size: 5
  threshold: 0.1
  polynomial_degree: 2

decision:
  physics_threshold: 0.1
  divergence_threshold: 30.0
  uncertainty_threshold: 50.0
```

### Loading Configuration

```python
from safer_v3.utils.config import SAFERConfig

config = SAFERConfig.from_yaml('config.yaml')
```

## Testing

```bash
# Run all tests
pytest tests/

# Run with coverage
pytest tests/ --cov=safer_v3 --cov-report=html

# Run specific test
pytest tests/test_mamba.py -v
```

## License

[License information]

## Citation

If you use SAFER v3.0 in your research, please cite:

```bibtex
@software{safer_v3,
  title = {SAFER v3.0: Scalable Aerospace Failure Estimation Runtime},
  year = {2024},
  description = {Tri-partite architecture for turbofan engine prognostics}
}
```

## Acknowledgments

- NASA Prognostics Center of Excellence for C-MAPSS dataset
- Mamba architecture from "Mamba: Linear-Time Sequence Modeling with Selective State Spaces"
- SINDy methodology from "Discovering governing equations from data"
